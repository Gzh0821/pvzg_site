var $=t=>{throw TypeError(t)};var w=(t,e,i)=>e.has(t)||$("Cannot "+i);var s=(t,e,i)=>(w(t,e,"read from private field"),i?i.call(t):e.get(t)),r=(t,e,i)=>e.has(t)?$("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),c=(t,e,i,n)=>(w(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i),l=(t,e,i)=>(w(t,e,"access private method"),i);import{R as L,c as N}from"./vidstack-EIUG4XP7-CX5MlRC-.js";import{a as U,bC as D,bD as S,bE as Y,t as C,x as j,i as y,U as z,s as F,_ as G}from"./app-C4y6je7v.js";var p,g,f,O,_,I,J=(I=class{constructor(t,e){r(this,f);r(this,p);r(this,g);c(this,p,t),c(this,g,e),t.textTracks.onaddtrack=l(this,f,O).bind(this),C(l(this,f,_).bind(this))}},p=new WeakMap,g=new WeakMap,f=new WeakSet,O=function(t){let e=t.track;if(!e||K(s(this,p),e))return;let i=new j({id:e.id,kind:e.kind,label:e.label??"",language:e.language,type:"vtt"});i[y.native]={track:e},i[y.readyState]=2,i[y.nativeHLS]=!0;let n=0,M=H=>{if(e.cues)for(let b=n;b<e.cues.length;b++)i.addCue(e.cues[b],H),n++};M(t),e.oncuechange=M,s(this,g).textTracks.add(i,t),i.setMode(e.mode,t)},_=function(){var t;s(this,p).textTracks.onaddtrack=null;for(let e of s(this,g).textTracks){let i=(t=e[y.native])==null?void 0:t.track;i!=null&&i.oncuechange&&(i.oncuechange=null)}},I);function K(t,e){return Array.from(t.children).find(i=>i.track===e)}var u,x,P,q,A,k,E,Q=(E=class{constructor(t,e){r(this,P);r(this,u);r(this,x);r(this,k,(t,e)=>{s(this,x).notify("picture-in-picture-change",t,e)});c(this,u,t),c(this,x,e),new z(t).add("enterpictureinpicture",l(this,P,q).bind(this)).add("leavepictureinpicture",l(this,P,A).bind(this))}get active(){return document.pictureInPictureElement===s(this,u)}get supported(){return S(s(this,u))}async enter(){return s(this,u).requestPictureInPicture()}exit(){return document.exitPictureInPicture()}},u=new WeakMap,x=new WeakMap,P=new WeakSet,q=function(t){s(this,k).call(this,!0,t)},A=function(t){s(this,k).call(this,!1,t)},k=new WeakMap,E),d,v,a,m,B,V,W=(V=class{constructor(t,e){r(this,m);r(this,d);r(this,v);r(this,a,"inline");c(this,d,t),c(this,v,e),F(t,"webkitpresentationmodechanged",l(this,m,B).bind(this))}get mode(){return s(this,a)}get supported(){return D(s(this,d))}async setPresentationMode(t){s(this,a)!==t&&s(this,d).webkitSetPresentationMode(t)}},d=new WeakMap,v=new WeakMap,a=new WeakMap,m=new WeakSet,B=function(t){var i;let e=s(this,a);c(this,a,s(this,d).webkitPresentationMode),(i=s(this,v).player)==null||i.dispatch(new G("video-presentation-change",{detail:s(this,a),trigger:t})),["fullscreen","picture-in-picture"].forEach(n=>{(s(this,a)===n||e===n)&&s(this,v).notify(`${n}-change`,s(this,a)===n,t)})},V),h,R,X=(R=class{constructor(t){r(this,h);c(this,h,t)}get active(){return s(this,h).mode==="fullscreen"}get supported(){return s(this,h).supported}async enter(){s(this,h).setPresentationMode("fullscreen")}async exit(){s(this,h).setPresentationMode("inline")}},h=new WeakMap,R),o,T,Z=(T=class{constructor(t){r(this,o);c(this,o,t)}get active(){return s(this,o).mode==="picture-in-picture"}get supported(){return s(this,o).supported}async enter(){s(this,o).setPresentationMode("picture-in-picture")}async exit(){s(this,o).setPresentationMode("inline")}},o=new WeakMap,T),st=class extends L{constructor(t,e){super(t,e),this.$$PROVIDER_TYPE="VIDEO",U(()=>{if(this.airPlay=new N(t,e),D(t)){let i=new W(t,e);this.fullscreen=new X(i),this.pictureInPicture=new Z(i)}else S(t)&&(this.pictureInPicture=new Q(t,e))},this.scope)}get type(){return"video"}setup(){super.setup(),Y(this.video)&&new J(this.video,this.ctx),this.ctx.textRenderers.attachVideo(this.video),C(()=>{this.ctx.textRenderers.attachVideo(null)}),this.type==="video"&&this.ctx.notify("provider-setup",this)}get video(){return this.media}};export{st as VideoProvider};
