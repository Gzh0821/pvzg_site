var F=e=>{throw TypeError(e)};var P=(e,h,t)=>h.has(e)||F("Cannot "+t);var n=(e,h,t)=>(P(e,h,"read from private field"),t?t.call(e):h.get(e)),u=(e,h,t)=>h.has(e)?F("Cannot add the same private member more than once"):h instanceof WeakSet?h.add(e):h.set(e,t),v=(e,h,t,i)=>(P(e,h,"write to private field"),i?i.call(e,t):h.set(e,t),t),r=(e,h,t)=>(P(e,h,"access private method"),t);import{aG as S,aP as B,aH as G,F as d,aQ as Q,g as T,Y as b,X,bl as Y}from"./app-zG_0mfGF.js";var o,s,y,N,O,f,A,m,L,w,x,H,C,M,$,j=($=class extends S{constructor(){super(...arguments);u(this,s);u(this,o);u(this,m,"")}onSetup(){v(this,o,G()),r(this,s,L).call(this),r(this,s,w).call(this),r(this,s,x).call(this),r(this,s,O).call(this)}onAttach(t){t.style.setProperty("pointer-events","none"),d(r(this,s,A).bind(this)),d(r(this,s,L).bind(this)),d(r(this,s,w).bind(this)),d(r(this,s,x).bind(this)),d(r(this,s,O).bind(this));let{started:i}=n(this,o).$state;this.setAttributes({"data-visible":()=>!i()&&!this.$state.hidden(),"data-loading":r(this,s,f).bind(this),"data-error":r(this,s,y).bind(this),"data-hidden":this.$state.hidden})}onConnect(t){d(r(this,s,N).bind(this)),d(r(this,s,H).bind(this))}},o=new WeakMap,s=new WeakSet,y=function(){let{error:t}=this.$state;return!Q(t())},N=function(){let{canLoadPoster:t,poster:i}=n(this,o).$state;!t()&&i()&&T(i(),"preconnect")},O=function(){let{src:t}=this.$props,{poster:i,nativeControls:a}=n(this,o).$state;this.el&&b(this.el,"display",a()?"none":null),this.$state.hidden.set(r(this,s,y).call(this)||!(t()||i())||a())},f=function(){let{loading:t,hidden:i}=this.$state;return!i()&&t()},A=function(){let t=this.$state.img();t&&(new X(t).add("load",r(this,s,C).bind(this)).add("error",r(this,s,M).bind(this)),t.complete&&r(this,s,C).call(this))},m=new WeakMap,L=function(){let{poster:t}=n(this,o).$props,{canLoadPoster:i,providedPoster:a,inferredPoster:p}=n(this,o).$state,c=this.$props.src()||"",E=c||t()||p();n(this,m)===a()&&a.set(c),this.$state.src.set(i()&&E.length?E:null),v(this,m,c)},w=function(){let{src:t}=this.$props,{alt:i}=this.$state,{poster:a}=n(this,o).$state;i.set(t()||a()?this.$props.alt():null)},x=function(){let{crossOrigin:t}=this.$props,{crossOrigin:i}=this.$state,{crossOrigin:a,poster:p}=n(this,o).$state,c=t()!==null?t():a();i.set(/ytimg\.com|vimeo/.test(p()||"")?null:c===!0?"anonymous":c)},H=function(){let{loading:t,error:i}=this.$state,{canLoadPoster:a,poster:p}=n(this,o).$state;t.set(a()&&!!p()),i.set(null)},C=function(){let{loading:t,error:i}=this.$state;t.set(!1),i.set(null)},M=function(t){let{loading:i,error:a}=this.$state;i.set(!1),a.set(t)},$.props={src:null,alt:null,crossOrigin:null},$.state=new B({img:null,src:null,alt:null,crossOrigin:null,loading:!0,error:null,hidden:!1}),$),l,g,z=(g=class extends Y(HTMLElement,j){constructor(){super(...arguments);u(this,l,document.createElement("img"))}onSetup(){this.$state.img.set(n(this,l))}onConnect(){let{src:t,alt:i,crossOrigin:a}=this.$state;d(()=>{let{loading:p,hidden:c}=this.$state;n(this,l).style.display=p()||c()?"none":""}),d(()=>{b(n(this,l),"alt",i()),b(n(this,l),"crossorigin",a()),b(n(this,l),"src",t())}),n(this,l).parentNode!==this&&this.prepend(n(this,l))}},l=new WeakMap,g.tagName="media-poster",g.attrs={crossOrigin:"crossorigin"},g);export{z as MediaPosterElement};
